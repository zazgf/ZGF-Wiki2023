<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Ros - ZGF Wiki</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Ros";
    var mkdocs_page_input_path = "Ros.md";
    var mkdocs_page_url = "/Ros/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> ZGF Wiki</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../c++/">C++</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../python/">Python</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ubuntu18/">Ubuntu18</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Ros</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#ros-create-msg">Ros create msg</a></li>
    

    <li class="toctree-l2"><a href="#msg">引用其他包的ｍｓｇ</a></li>
    

    <li class="toctree-l2"><a href="#sudo-rosdep-init-rosdep-update">sudo rosdep init &amp;rosdep update失败</a></li>
    

    <li class="toctree-l2"><a href="#vscode-python-ros-debug">vscode python ros debug</a></li>
    

    <li class="toctree-l2"><a href="#error-package-teleop_twist_keyboard-not-found">Error: package 'teleop_twist_keyboard' not found</a></li>
    

    <li class="toctree-l2"><a href="#spawn-service-failed-exiting">Spawn service failed. Exiting.</a></li>
    

    <li class="toctree-l2"><a href="#createquaternionfromrpy">createQuaternionFromRPY</a></li>
    

    <li class="toctree-l2"><a href="#launch-rviz">launch 启动 rviz</a></li>
    

    <li class="toctree-l2"><a href="#rosdep">rosdep失败</a></li>
    

    <li class="toctree-l2"><a href="#ros-node">ros node 打包</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#_1">安装依赖</a></li>
        
            <li><a class="toctree-l3" href="#_2">准备</a></li>
        
            <li><a class="toctree-l3" href="#debian">生成debian包</a></li>
        
            <li><a class="toctree-l3" href="#rosanaconda">ros总是链接anaconda下的库文件</a></li>
        
            <li><a class="toctree-l3" href="#use-parent-frame_id-display">Use parent frame_id Display</a></li>
        
            <li><a class="toctree-l3" href="#tf">如何发布tf转换关系</a></li>
        
            <li><a class="toctree-l3" href="#roslaunch-roslaunch">roslaunch 包含 roslaunch文件</a></li>
        
            <li><a class="toctree-l3" href="#roslaunch-yaml">roslaunch 包含yaml 文件</a></li>
        
            <li><a class="toctree-l3" href="#roslaunch-py-node">roslaunch py node</a></li>
        
            <li><a class="toctree-l3" href="#ros">ros 更换中科大源</a></li>
        
            <li><a class="toctree-l3" href="#ros_1">ros 阿里源</a></li>
        
            <li><a class="toctree-l3" href="#ros-clock">Ros clock</a></li>
        
            <li><a class="toctree-l3" href="#ros-topic">Ros 查看Topic</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Ros建模/">Ros建模</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../tf_document/">tf_document</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../caffe/">Caffe</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../deeplearning/">deeplearning</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../voxelnet/">voxelnet</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../radar_camera_fusion/">radar_camera</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../python有用的函数/">python有用的函数(一)</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../OpenCV/">OpenCV</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../harbor/">Harbor</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Atlas200验收报告/">Atlas200验收报告</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../激光雷达算法盒子/">激光雷达算法盒子</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../radar_camera_fusion/">radar_camera_fusion</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../毫米波和摄像机融合/">毫米波和摄像机融合</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">ZGF Wiki</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Ros</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h3 id="ros-create-msg">Ros create msg</h3>
<ul>
<li>在node节点文件夹下创建msg文件夹</li>
<li>在msg文件夹下创建 **.msg文件</li>
</ul>
<p>detect.msg</p>
<pre><code class="language-python">bool begin
string first_name
string last_name
uint8 age
uint32 score
int64 stateLabel
int64 CIPV
int64 trackID
int64 trackFrameNum
int64 obstacleType
float32 real3DRightX
float32 real3DLeftX
float32 width
float32 real3DLowY
float32 real3DUpY
float32 height
float32 HMW
float32 fuzzyCollisionTimeZ
float32 longitudinalZ
float32 speedOfLongitudinal
float32 lateralX
float32 speedOfLateral
float32 currentSpeed
</code></pre>
<p>detect_array.msg</p>
<pre><code class="language-python">dectect []
</code></pre>
<p>package.xml</p>
<pre><code class="language-xml">&lt;build_depend&gt;message_generation&lt;/build_depend&gt;
&lt;exec_depend&gt;message_runtime&lt;/exec_depend&gt;
</code></pre>
<p>CMakelists.txt</p>
<pre><code class="language-python">find_package(catkin REQUIRED COMPONENTS
   roscpp
   rospy
   std_msgs
   message_generation
)

catkin_package(
  ...
  CATKIN_DEPENDS message_runtime ...
  ...)

add_message_files(
  FILES
  detect.msg
  detect_array.msg
)


generate_messages(
  DEPENDENCIES
  std_msgs
)


</code></pre>
<ul>
<li>包含头文件</li>
</ul>
<pre><code class="language-cpp">#include &quot;smart_eye/detect.h&quot;
#include &quot;smart_eye/detect_array.h&quot;

msg_pub = nh_.advertise&lt;smart_eye::detect_array&gt;(&quot;detect_array&quot;, 10);

smart_eye::detect msg;
smart_eye::detect_array msg_array;
msg.stateLabel = stateLabel;
msg.CIPV = CIPV;
msg.trackID = trackID;
msg.trackFrameNum = trackFrameNum;
msg.obstacleType = obstacleType;
msg.real3DRightX = real3DRightX;
msg.real3DLeftX = real3DLeftX;
msg.width = width;
msg.real3DLowY = real3DLowY;
msg.real3DUpY = real3DUpY;
msg.height = height;
msg.HMW = HMW;
msg.fuzzyCollisionTimeZ = fuzzyCollisionTimeZ;
msg.longitudinalZ = longitudinalZ;
msg.speedOfLongitudinal = speedOfLongitudinal;
msg.lateralX = lateralX;
msg.speedOfLateral = speedOfLateral;
msg.currentSpeed = currentSpeed;
msg_array.push(msg);
msg_pub.publish(msg_array);
</code></pre>
<h3 id="msg">引用其他包的ｍｓｇ</h3>
<p>首先cmakelists.txt</p>
<pre><code class="language-css">find_package(catkin REQUIRED COMPONENTS
  message_generation
  pcl_ros
  roscpp
  rospy
  std_msgs
  wjj
)

catkin_package(
 INCLUDE_DIRS include
 CATKIN_DEPENDS message_runtime pcl_ros roscpp rospy std_msgs wjj
)

add_dependencies(teaching 
${catkin_EXPORTED_TARGETS}
wjj_gencpp)
</code></pre>
<p>再者package.xml</p>
<pre><code> &lt;build_depend&gt;wjj&lt;/build_depend&gt;
 &lt;exec_depend&gt;wjj&lt;/exec_depend&gt;
</code></pre>
<p>最后使用</p>
<pre><code>#include &lt;wjj/SaeJ1939.h&gt;
</code></pre>
<h2 id="sudo-rosdep-init-rosdep-update">sudo rosdep init &amp;rosdep update失败</h2>
<p>该解决方案是针对由于以下两个无法正常访问，但可以ping通，于是修改hosts文件，加入以下两个网址的IP地址实现访问。</p>
<p>'sudo gedit /etc/hosts'</p>
<p>添加</p>
<pre><code class="language-bash">199.232.28.133  raw.githubusercontent.com
151.101.228.133  raw.github.com

</code></pre>
<p>修改完成后，在终端执行</p>
<pre><code class="language-bash">sudo rosdep init
redep update
</code></pre>
<h2 id="vscode-python-ros-debug">vscode python ros debug</h2>
<p>首先</p>
<pre><code class="language-bash">catkin_make -DCMAKE_BUILD_TYPE=DEBUG
</code></pre>
<p>其次点击debug按扭,再点击`create a launch.json file</p>
<p><img alt="" src="../images/Screenshot2021-06-0316:44:55.png" /></p>
<p>选择 <code>Show</code></p>
<p><img alt="" src="../images/Screenshot2021-06-0316:36:37.png" /></p>
<p>选择 <code>Add Configuration..</code></p>
<p><img alt="" src="../images/Screenshotfrom2021-06-0316-39-03.png" /></p>
<p>再添加 <code>Ros Attach</code>
<img alt="" src="../images/Screensho2021-06-036-47-03.png" /></p>
<p><code>launch.json</code></p>
<pre><code class="language-json">{
    &quot;version&quot;: &quot;0.2.0&quot;,
    &quot;configurations&quot;: [
        {
            &quot;name&quot;: &quot;ROS: Attach&quot;,
            &quot;type&quot;: &quot;ros&quot;,
            &quot;request&quot;: &quot;attach&quot;
        }

    ]
}
</code></pre>
<p>ｄebug时遇到路径问题,例如rosmsg路径，最好在文件属性里复制路径，不然容易出错</p>
<pre><code class="language-python">import sys
sys.path.append(&quot;/home/pmjd/Downloads/catkin_ws/devel/lib/python2.7/dist-packages&quot;)
</code></pre>
<h2 id="error-package-teleop_twist_keyboard-not-found">Error: package 'teleop_twist_keyboard' not found</h2>
<p>You need to download the teleop_twist_keyboard from the github to your ~/catkin_ws/src folder. Steps:</p>
<p>1) <code>cd ~/catkin_ws/src</code>
2) <code>git clone https://github.com/ros-teleop/teleop_twist_keyboard</code></p>
<h2 id="spawn-service-failed-exiting">Spawn service failed. Exiting.</h2>
<pre><code class="language-bash">export ROS_MASTER_URI=http://promote-OMEN-by-HP-Laptop-17-cb1xxx:11311/
</code></pre>
<h2 id="createquaternionfromrpy">createQuaternionFromRPY</h2>
<p>static geometry_msgs::Quaternion createQuaternionFromRPY(double roll, double pitch, double yaw) {
geometry_msgs::Quaternion q;
double t0 = cos(yaw * 0.5);
double t1 = sin(yaw * 0.5);
double t2 = cos(roll * 0.5);
double t3 = sin(roll * 0.5);
double t4 = cos(pitch * 0.5);
double t5 = sin(pitch * 0.5);
q.w = t0 * t2 * t4 + t1 * t3 * t5;
q.x = t0 * t3 * t4 - t1 * t2 * t5;
q.y = t0 * t2 * t5 + t1 * t3 * t4;
q.z = t1 * t2 * t4 - t0 * t3 * t5;
return q;
}</p>
<h2 id="launch-rviz">launch 启动 rviz</h2>
<pre><code class="language-bash">&lt;launch&gt;
  &lt;node type=&quot;rviz&quot; name=&quot;rviz&quot; pkg=&quot;rviz&quot; args=&quot;-d $(find package_name)/rviz/config_file.rviz&quot; /&gt;
&lt;/launch&gt;
</code></pre>
<h2 id="rosdep">rosdep失败</h2>
<p>首先 <code>sudo rosdep init</code></p>
<p>这一步会在 <code>/etc/ros/rosdep/sources.list.d/</code>目录下新建 <code>20-default.list</code></p>
<pre><code class="language-bash"># os-specific listings first
yaml https://raw.githubusercontent.com/ros/rosdistro/master/rosdep/osx-homebrew.yaml osx

# generic
yaml https://raw.githubusercontent.com/ros/rosdistro/master/rosdep/base.yaml
yaml https://raw.githubusercontent.com/ros/rosdistro/master/rosdep/python.yaml
yaml https://raw.githubusercontent.com/ros/rosdistro/master/rosdep/ruby.yaml
gbpdistro https://raw.githubusercontent.com/ros/rosdistro/master/releases/fuerte.yaml fuerte

# newer distributions (Groovy, Hydro, ...) must not be listed anymore, they are being fetched from the rosdistro index.yaml instead

</code></pre>
<p>我们需要依次下载 <code>osx-homebrew.yaml</code>等这几个 <code>yaml</code>文件,<a href="https://d.serctl.com/">下载工具</a>, 存放在/home/promote/Downloads目录下</p>
<p>然后更改 <code>20-default.list</code>为</p>
<pre><code class="language-bash"># os-specific listings first
yaml file:///home/promote/Downloads/2021-04-01-14-01-21-master-osx-homebrew.yaml osx

# generic
yaml file:///home/promote/Downloads/2021-04-01-14-02-25-master-base.yaml
yaml file:///home/promote/Downloads/2021-04-01-14-05-35-master-python.yaml
yaml file:///home/promote/Downloads/2021-04-01-14-06-50-master-ruby.yaml
gbpdistro file:///home/promote/Downloads/2021-04-01-14-07-41-master-fuerte.yaml fuerte

# newer distributions (Groovy, Hydro, ...) must not be listed anymore, they are being fetched from the rosdistro index.yaml instead

</code></pre>
<p>还需要使用 <code>mate-search-tool</code> 在 <code>/usr/lib/</code>目录下找到包含 <code>DEFAULT_INDEX_URL</code> 的 <code>py</code>文件。<code>/usr/lib/python2.7/dist-packages/rosdistro/__init__.py</code></p>
<p>找到代码行</p>
<pre><code class="language-python">DEFAULT_INDEX_URL = 'https://raw.githubusercontent.com/ros/rosdistro/master/index-v4.yaml'
</code></pre>
<p>同样我们下载 <code>index-v4.yaml</code>文件至 <code>/home/promote/Downloads</code>，把此行代码改为</p>
<pre><code class="language-python"># DEFAULT_INDEX_URL = 'https://raw.githubusercontent.com/ros/rosdistro/master/index-v4.yaml'
DEFAULT_INDEX_URL = 'file:/home/promote/Downloads/2021-04-01-14-51-42-rosdistro-index-v4.yaml'

</code></pre>
<p>这时再运行 <code>rosdep update</code></p>
<p>会提示 <code>No such file or directory: '/home/promote/Downloads/dashing/distribution.yaml'</code></p>
<p>我们需要下载 <code>https://raw.githubusercontent.com/ros/rosdistro/master/dashing/distribution.yaml</code></p>
<p>在 <code>/home/promote/Downloads</code>目录下新建文件夹 <code>dashing</code>，并把下载的 <code>yaml</code>文件放入 <code>dashing</code>文件夹下重命名为 <code>distribution.yaml</code></p>
<p>重复上一步，依次下载完 <code>dashing, kinetic, melodic, rolling, noetic, foxy</code>等</p>
<p>再运行 <code>rosdep update</code>就成功了</p>
<h2 id="ros-node">ros node 打包</h2>
<h3 id="_1">安装依赖</h3>
<p>Install <a href="http://ros-infrastructure.github.io/bloom/">bloom</a>:</p>
<pre><code class="language-shell">sudo apt-get install python-bloom
</code></pre>
<p>or (recommended)</p>
<pre><code class="language-shell">sudo pip install -U bloom
</code></pre>
<p>Install fakeroot:</p>
<pre><code class="language-shell">sudo apt-get install fakeroot
</code></pre>
<h3 id="_2">准备</h3>
<p>To make a debian folder structure from the ROS package you must cd into the package to be in the same folder where <code>package.xml</code> file is.</p>
<h3 id="debian">生成debian包</h3>
<pre><code class="language-bash">bloom-generate rosdebian --os-name ubuntu --os-version trusty --ros-distro indigo
</code></pre>
<h3 id="rosanaconda">ros总是链接anaconda下的库文件</h3>
<pre><code class="language-bash">export LD_LIBRARY_PATH=&quot;&quot;
</code></pre>
<h3 id="use-parent-frame_id-display">Use parent frame_id Display</h3>
<ul>
<li>在launch文件里添加</li>
</ul>
<pre><code class="language-xml">&lt;node pkg=&quot;tf&quot;  type=&quot;static_transform_publisher&quot; name=&quot;base_to_map&quot; args=&quot;1000 0 0 0 0 0 /base_link /map 50&quot; &gt;

&lt;node pkg=&quot;ros2qt&quot; type=&quot;ros2qt&quot; name=&quot;ros2qt&quot; &gt;
    &lt;rosparam&gt;
        use_sim_time: true
    &lt;/rosparam&gt;
&lt;/node&gt;
&lt;node pkg=&quot;ros2qt&quot; type=&quot;myclock.py&quot; name =&quot;myclock&quot;/&gt;
</code></pre>
<p>myclock.py</p>
<pre><code class="language-python">#!/usr/bin/python
import rospy
from rosgraph_msgs.msg import Clock
import time

def simtime_talker():
    rospy.set_param('use_sim_time',False)
    pub1 = rospy.Publisher('clock',Clock, queue_size=10)
    rospy.init_node('talker', anonymous=True)
    rate = rospy.Rate(10) # 10hz
    sim_speed_multiplier = 10  
    sim_clock = Clock()
    zero_time = rospy.get_time()
    while not rospy.is_shutdown():
        sim_clock.clock = rospy.Time.from_sec(sim_speed_multiplier*(rospy.get_time() - zero_time))
        rospy.loginfo(sim_clock)
        pub1.publish(sim_clock)
        rate.sleep()
if __name__ == '__main__':
    try:
        simtime_talker()
    except rospy.ROSInterruptException:
        pass
</code></pre>
<ul>
<li>在终端建立父子关系</li>
</ul>
<pre><code class="language-bash">rosrun tf stat_transform_publisher 0 0 1 0 0 0 1 base_link rslidar 50
</code></pre>
<ul>
<li>即可在rviz里设置 <code>fixed frame</code> 为 <code>base_link</code>,观看点云数据</li>
</ul>
<h3 id="tf">如何发布tf转换关系</h3>
<ul>
<li>Use <strong>static_transform_publisher</strong> -- this one is a ready to use node, that you can run from command line.</li>
</ul>
<pre><code class="language-bash">rosrun tf stat_transform_publisher 0 0 1 0 0 0  world rslidar 50
</code></pre>
<ul>
<li>Use <a href="https://wiki.ros.org/tf/Tutorials/Writing%20a%20tf%20broadcaster%20(C++)">tf::TransformBroadcaster</a> -- to create transforms in a code.</li>
</ul>
<pre><code class="language-cpp">
void QNode::biaodingCallback(const PointCloud::ConstPtr&amp; msg)
{
    frame_name = msg-&gt;header.frame_id;
    static tf::TransformBroadcaster br;
    tf::Transform transform;
    transform.setOrigin( tf::Vector3(x_pianyi, y_pianyi, z_pianyi) );
    tf::Quaternion q;
    q.setRPY(x_xuanzhuan, y_xuanzhuan, z_xuanzhuan);
    transform.setRotation(q);
    br.sendTransform(tf::StampedTransform(transform, ros::Time::now(), &quot;base_link&quot;, frame_name));
}
</code></pre>
<h3 id="roslaunch-roslaunch">roslaunch 包含 roslaunch文件</h3>
<pre><code class="language-xml">&lt;include file=&quot;$(find robot_description)/launch/urdf_test.launch&quot; /&gt; 
</code></pre>
<h3 id="roslaunch-yaml">roslaunch 包含yaml 文件</h3>
<pre><code class="language-xml">&lt;rosparam file=&quot;$(find ldtest)/config/para.yaml&quot; command=&quot;load&quot; /&gt;
</code></pre>
<p>para.yaml</p>
<pre><code class="language-python">x_offset: -1.45
y_offset: 0.56
z_offset: 2.95
x_jiaodu: -1.5
y_jiaodu: 44.3
z_jiaodu: 4.0
stone2car_x: -1.25
stone2car_y: 5.35
stone2car_z: -1.0
dipan_init_jiaodu: 91.4
remote: true
</code></pre>
<h3 id="roslaunch-py-node">roslaunch py node</h3>
<pre><code class="language-xml">&lt;node name=&quot;LidarTool&quot; pkg=&quot;ldtest&quot;
    type=&quot;LidarTool.py&quot; required=&quot;false&quot;
    output=&quot;screen&quot;
/&gt;
</code></pre>
<h3 id="ros">ros 更换中科大源</h3>
<pre><code>sudo nano /etc/apt/sources.list.d/ros-latest.list
</code></pre>
<p>添加</p>
<p><code>deb http://mirrors.ustc.edu.cn/ros/ubuntu/ bionic main</code></p>
<h3 id="ros_1">ros 阿里源</h3>
<p><code>deb https://mirrors.aliyun.com/ros/ubuntu/ bionic main</code></p>
<h3 id="ros-clock">Ros clock</h3>
<pre><code class="language-python">#!/usr/bin/python
import rospy
from rosgraph_msgs.msg import Clock
import time

def simtime_talker():
    rospy.set_param('use_sim_time',False)
    pub1 = rospy.Publisher('clock',Clock, queue_size=10)
    rospy.init_node('talker', anonymous=True)
    rate = rospy.Rate(10) # 10hz
    sim_speed_multiplier = 10  
    sim_clock = Clock()
    zero_time = rospy.get_time()
    while not rospy.is_shutdown():
        sim_clock.clock = rospy.Time.from_sec(sim_speed_multiplier*(rospy.get_time() - zero_time))
        rospy.loginfo(sim_clock)
        pub1.publish(sim_clock)
        rate.sleep()
if __name__ == '__main__':
    try:
        simtime_talker()
    except rospy.ROSInterruptException:
        pass
</code></pre>
<p><strong>有些msg不显示，是因为时间落后问题。</strong></p>
<pre><code class="language-xml">&lt;launch&gt;
&lt;node pkg=&quot;ros2qt&quot; type=&quot;ros2qt&quot; name=&quot;ros2qt&quot; &gt;
&lt;rosparam&gt;
    use_sim_time: true
&lt;/rosparam&gt;
&lt;/node&gt;
&lt;node pkg=&quot;ros2qt&quot; type=&quot;myclock.py&quot; name =&quot;myclock&quot;/&gt;
&lt;include file=&quot;$(find rslidar_pointcloud)/launch/rs_lidar_16.launch&quot; /&gt;
&lt;/launch&gt;
</code></pre>
<p>在开启一个Node之前，当把 <code>use_sim_time</code>设置为 <code>true</code>时，这个节点会从clock Topic获得时间。所以操作这个clock的发布者，可以实现一个让Node中得到ROS Time暂停、加速、减速的效果。同时下面这些方面都是跟Node透明的，所以非常适合离线的调试方式。当把ROSbag记下来以后重新play出来时，加两个横杠，--clock，它就会发布出这个消息。</p>
<h3 id="ros-topic">Ros 查看Topic</h3>
<pre><code class="language-c++">QMap&lt;QString,QString&gt; QNode::get_topic_list()
{
    ros::master::V_TopicInfo topic_list;
    ros::master::getTopics(topic_list);
    QMap&lt;QString,QString&gt; res;
    for(auto topic:topic_list)
    {
        res.insert(QString::fromStdString(topic.name),QString::fromStdString(topic.datatype));
    }
    return res;
}

</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Ros建模/" class="btn btn-neutral float-right" title="Ros建模">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../ubuntu18/" class="btn btn-neutral" title="Ubuntu18"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../ubuntu18/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../Ros建模/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="../mathjaxhelper.js"></script>

</body>
</html>
